name: Ubuntu 22.04 LTS Tests

on:
  workflow_dispatch:
#  push:
#    branches:
#      - workflows_2023_08_week1
#      - development
  pull_request_target:
    types: [opened, reopened]
    branches: [development]

jobs:
  test1:
    runs-on: [self-hosted, jan16core]
    steps:
      - uses: actions/checkout@v2
      - name: configure
        shell: bash -l {0}
        run: |
          module load chi-tech-mpich-4.0.2-gcc-12.2.0
          ./configure.sh
      - name: make
        shell: bash -l {0}
        run: |
          module load chi-tech-mpich-4.0.2-gcc-12.2.0
          make -j16
      - name: test
        shell: bash -l {0}
        run: |
          module load chi-tech-mpich-4.0.2-gcc-12.2.0
          test/run_tests -d test/framework -j 16 -v 1 -w 1